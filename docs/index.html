<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title>&#x203B;&#x30C9;&#x30C3;&#x30AB;&#x30FC;&#x306F;&#x30A4;&#x30E1;&#x30FC;&#x30B8;&#x3067;&#x3059;</title><meta charset="UTF-8"></meta><meta name="generator" content="Hovercraft! 1.0 http://regebro.github.com/hovercraft"></meta><link rel="stylesheet" href="css/hovercraft.css" media="all"></link><link rel="stylesheet" href="css/impressConsole.css" media="all"></link><link rel="stylesheet" href="css/highlight.css" media="all"></link><link rel="stylesheet" href="style.css" media="screen,projection"></link><script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        showProcessingMessages: false,
        messageStyle: "none",
        TeX : { extensions : ['color.js'] }
      });
    </script></head><body class="impress-not-supported"><div id="impress" data-transition-duration="0"><div class="step step-level-1" step="0" data-x="0" data-y="1000" id="title" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-z="0"><h1 id="id1">&#x203B;&#x30C9;&#x30C3;&#x30AB;&#x30FC;&#x306F;&#x30A4;&#x30E1;&#x30FC;&#x30B8;&#x3067;&#x3059;</h1><p>&#x30C9;&#x30C3;&#x30AB;&#x30FC;&#x30A4;&#x30E1;&#x30FC;&#x30B8;&#x306E;&#x826F;&#x3044;&#x4F5C;&#x308A;&#x65B9;</p></div><div class="step step-level-1" step="1" id="intro" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="2000" data-z="0"><figure><a href="https://sfiera.net"><img src="img/portrait.png"></img></a><figcaption>&#x203B;&#x5199;&#x771F;&#x306F;&#x30A4;&#x30E1;&#x30FC;&#x30B8;&#x3067;&#x3059;</figcaption></figure><h1 id="intro">Intro</h1><ul><li>Chris Pickel <span class="invert">&#x26CF;</span></li><li><a href="https://github.com/sfiera">github.com/sfiera</a></li><li>New York &#x2192; Kyoto</li><li><span class="invert">&#x1F436; &#x1F355; &#x26F0; &#x1F682; &#x1F3EF;</span></li></ul></div><div class="step step-level-1" step="2" id="image" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="3000" data-z="0"><figure><a href="https://commons.wikimedia.org/wiki/File:Scomber_japonicus_(Matsuwasaba).jpg"><img src="img/saba-container.jpg"></img></a><figcaption>&#x203B;&#x5199;&#x771F;&#x306F;&#x30A4;&#x30E1;&#x30FC;&#x30B8;&#x3067;&#x3059;</figcaption></figure><h1 id="image">Image</h1><ul><li>Server + Deps =
Container</li></ul></div><div class="step step-level-1" step="3" id="goals" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="4000" data-z="0"><figure><a href="https://commons.wikimedia.org/wiki/File:Venn_diagram_coloured.svg"><img src="img/venn.png"></img></a><figcaption>&#x203B;&#x5199;&#x771F;&#x306F;&#x30A4;&#x30E1;&#x30FC;&#x30B8;&#x3067;&#x3059;</figcaption></figure><h1 id="goals">Goals</h1><ul><li>Fast</li><li>Small</li><li>Correct</li></ul></div><div class="step step-level-1" step="4" id="fast" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="5000" data-z="0"><figure><a href="https://commons.wikimedia.org/wiki/File:Sabazushi_Izuju.jpg"><img src="img/sabazushi.jpg"></img></a><figcaption>&#x203B;&#x5199;&#x771F;&#x306F;&#x30A4;&#x30E1;&#x30FC;&#x30B8;&#x3067;&#x3059;</figcaption></figure><h1 id="fast">Fast</h1><ul><li>Fast build</li><li>Fast pull</li></ul></div><div class="step step-level-1" step="5" id="small" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="6000" data-z="0"><figure><a href="https://commons.wikimedia.org/wiki/File:Maquereaux_etal.jpg"><img src="img/many-saba.jpg"></img></a><figcaption>&#x203B;&#x5199;&#x771F;&#x306F;&#x30A4;&#x30E1;&#x30FC;&#x30B8;&#x3067;&#x3059;</figcaption></figure><h1 id="small">Small</h1><ul><li>Many servers</li><li>Fast pull</li></ul></div><div class="step step-level-1" step="6" id="correct" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="7000" data-z="0"><figure><a href="https://commons.wikimedia.org/wiki/File:Scomber_japonicus_San_Diego.jpg"><img src="img/saba-surprise.jpg"></img></a><figcaption>&#x203B;&#x5199;&#x771F;&#x306F;&#x30A4;&#x30E1;&#x30FC;&#x30B8;&#x3067;&#x3059;</figcaption></figure><h1 id="correct">Correct</h1><ul><li>Successful build</li><li>Reproducible build</li></ul></div><div class="step step-level-1" step="7" id="dockerfile" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="8000" data-z="0"><pre class="highlight code dockerfile"><span class="k">FROM</span><span class="s"> golang:1.13</span>

<span class="k">RUN</span> mkdir /src/
<span class="k">WORKDIR</span><span class="s"> /src/</span>
<span class="k">COPY</span> go.mod go.sum hello-world.go ./
<span class="k">RUN</span> go build hello-world.go
<span class="k">CMD</span> <span class="p">[</span><span class="s2">"/src/hello-world"</span><span class="p">]</span></pre></div><div class="step step-level-1" step="8" id="alpine" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="9000" data-z="0"><figure><a href="https://sfiera.net"><img src="img/alps.jpg"></img></a><figcaption>&#x203B;&#x5199;&#x771F;&#x306F;&#x30A4;&#x30E1;&#x30FC;&#x30B8;&#x3067;&#x3059;</figcaption></figure><h1 id="base-image">Base Image</h1><ul><li><tt>golang:1.13</tt> (Debian)</li><li><tt>golang:1.13-alpine</tt></li><li>823MB &#x2192; 380MB</li></ul></div><div class="step step-level-1" step="9" id="dockerfile2" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="10000" data-z="0"><pre class="highlight code dockerfile"><span class="k">FROM</span><span class="s"> golang:1.13-alpine AS builder</span>
<span class="k">RUN</span> mkdir /src/
<span class="k">WORKDIR</span><span class="s"> /src/</span>
<span class="k">COPY</span> go.mod go.sum hello-world.go ./
<span class="k">RUN</span> go build hello-world.go

<span class="k">FROM</span><span class="s"> alpine</span>
<span class="k">COPY</span> --from<span class="o">=</span>builder /src/hello-world /bin/
<span class="k">CMD</span> <span class="p">[</span><span class="s2">"/bin/hello-world"</span><span class="p">]</span></pre></div><div class="step step-level-1" step="10" id="2-stage" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="11000" data-z="0"><figure><a href="https://sfiera.net"><img src="img/alpine2.jpg"></img></a><figcaption>&#x203B;&#x5199;&#x771F;&#x306F;&#x30A4;&#x30E1;&#x30FC;&#x30B8;&#x3067;&#x3059;</figcaption></figure><h1 id="stage">2-stage</h1><table cellpadding="0" cellspacing="0"><thead><tr><th><p>Image</p></th><th><p>Debian</p></th><th><p>Alpine</p></th></tr></thead><tbody><tr><td><p>1stage</p></td><td><p>823MB</p></td><td><p>380MB</p></td></tr><tr><td><p>2stage</p></td><td><p>122MB</p></td><td><p>13.5MB</p></td></tr></tbody></table></div><div class="step step-level-1" step="11" id="base-size" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="12000" data-z="0"><figure><a href="https://sfiera.net"><img src="img/alpine3.jpg"></img></a><figcaption>&#x203B;&#x5199;&#x771F;&#x306F;&#x30A4;&#x30E1;&#x30FC;&#x30B8;&#x3067;&#x3059;</figcaption></figure><h1 id="base-size">Base Size</h1><table cellpadding="0" cellspacing="0"><thead><tr><th><p>Image</p></th><th><p>Debian</p></th><th><p>Alpine</p></th></tr></thead><tbody><tr><td><p>1stage</p></td><td><p>823MB</p></td><td><p>380MB</p></td></tr><tr><td><p>2stage</p></td><td><p>122MB</p></td><td><p>13.5MB</p></td></tr><tr><td><p>golang</p></td><td><p>803MB</p></td><td><p>359MB</p></td></tr><tr><td><p>base</p></td><td><p>114MB</p></td><td><p>5.58MB</p></td></tr></tbody></table></div><div class="step step-level-1" step="12" id="heavy" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="13000" data-z="0"><figure><a href="https://pxhere.com/en/photo/685672"><img src="img/scales.jpg"></img></a><figcaption>&#x203B;&#x5199;&#x771F;&#x306F;&#x30A4;&#x30E1;&#x30FC;&#x30B8;&#x3067;&#x3059;</figcaption></figure><h1 id="heavy">Heavy</h1><ul><li>alpine: 5.6MB</li><li>binary: 7.6MB</li><li>debian: 114MB</li></ul></div><div class="step step-level-1" step="13" id="minideb" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="14000" data-z="0"><figure><a href="https://commons.wikimedia.org/wiki/File:Little_Blue_Penguin_(Eudyptula_minor)_-group_at_Adelaide_Zoo.jpg"><img src="img/penguin.jpg"></img></a><figcaption>&#x203B;&#x5199;&#x771F;&#x306F;&#x30A4;&#x30E1;&#x30FC;&#x30B8;&#x3067;&#x3059;</figcaption></figure><h1 id="minideb">Minideb</h1><ul><li>alpine: 5.6MB</li><li>binary: 7.6MB</li><li>minideb: 67.5MB</li><li>debian: 114MB</li></ul></div><div class="step step-level-1" step="14" id="python" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="15000" data-z="0"><figure><a href="https://www.publicdomainpictures.net/en/view-image.php?image=281500&amp;picture=python-in-new-york"><img src="img/python.jpg"></img></a><figcaption>&#x203B;&#x5199;&#x771F;&#x306F;&#x30A4;&#x30E1;&#x30FC;&#x30B8;&#x3067;&#x3059;</figcaption></figure><h1 id="python">Python</h1><table cellpadding="0" cellspacing="0"><thead><tr><th><p>Image</p></th><th><p>Debian</p></th><th><p>Alpine</p></th></tr></thead><tbody><tr><td><p>base</p></td><td><p>114MB</p></td><td><p>5.58MB</p></td></tr><tr><td><p>golang</p></td><td><p>803MB</p></td><td><p>359MB</p></td></tr><tr><td><p>python</p></td><td><p>918MB</p></td><td><p>98.7MB</p></td></tr><tr><td><p>final</p></td><td><p>927MB</p></td><td><p>109MB</p></td></tr></tbody></table></div><div class="step step-level-1" step="15" id="download" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="16000" data-z="0"><figure><a href="https://www.flickr.com/photos/jumilla/8581200502/"><img src="img/wheel.jpg"></img></a><figcaption>&#x203B;&#x5199;&#x771F;&#x306F;&#x30A4;&#x30E1;&#x30FC;&#x30B8;&#x3067;&#x3059;</figcaption></figure><h1 id="download">Download</h1><ul><li>alpine: 5s (5.6MB)</li><li>debian: 8s (114MB)</li><li>golang: 20s (803MB)</li></ul></div><div class="step step-level-1" step="16" id="dockerfile3" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="17000" data-z="0"><pre class="highlight code dockerfile"><span class="k">FROM</span><span class="s"> golang:1.13-alpine AS builder</span>

<span class="k">RUN</span> mkdir /src/
<span class="k">WORKDIR</span><span class="s"> /src/</span>
<span class="k">COPY</span> go.mod go.sum ./
<span class="k">RUN</span> go mod download

<span class="k">COPY</span> hello-world.go ./
<span class="k">RUN</span> go build hello-world.go</pre></div><div class="step step-level-1" step="17" id="rebuild" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="18000" data-z="0"><figure><a href="https://sfiera.net"><img src="img/steam.jpg"></img></a><figcaption>&#x203B;&#x5199;&#x771F;&#x306F;&#x30A4;&#x30E1;&#x30FC;&#x30B8;&#x3067;&#x3059;</figcaption></figure><h1 id="rebuild">Rebuild</h1><ul><li>together: 26s &#x2192; 5.5s</li><li>separate: 27s &#x2192; 4.5s</li></ul></div><div class="step step-level-1" step="18" id="package" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="19000" data-z="0"><figure><a href="https://commons.wikimedia.org/wiki/File:Cardboard_Boxes_and_their_History.jpg"><img src="img/box.jpg"></img></a><figcaption>&#x203B;&#x5199;&#x771F;&#x306F;&#x30A4;&#x30E1;&#x30FC;&#x30B8;&#x3067;&#x3059;</figcaption></figure><h1 id="package">Package</h1><ul><li>go.mod, go.sum</li><li>Pipfile, requirements.txt</li><li>package.json</li><li>Gemfile</li></ul></div><div class="step step-level-1" step="19" id="dockerignore" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="20000" data-z="0"><figure><a href="https://www.flickr.com/photos/volvob12b/24538247898"><img src="img/dockerignore.jpg"></img></a><figcaption>&#x203B;&#x5199;&#x771F;&#x306F;&#x30A4;&#x30E1;&#x30FC;&#x30B8;&#x3067;&#x3059;</figcaption></figure><h1 id="ignore">Ignore</h1><ul><li><tt>Dockerfile</tt>:<pre class="highlight code dockerfile"><span class="k">COPY</span> ./ ./</pre></li><li><tt>.dockerignore</tt>:<pre class="highlight code dockerfile">Dockerfile</pre></li></ul></div><div class="step step-level-1" step="20" id="csaas" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="21000" data-z="0"><figure><img src="img/cowsay.png"></img><figcaption>&#x203B;&#x5199;&#x771F;&#x306F;&#x30A4;&#x30E1;&#x30FC;&#x30B8;&#x3067;&#x3059;</figcaption></figure><h1 id="cowsay-as-a-service-csaas">Cowsay As A Service (CSaaS)</h1><pre class="highlight code sh">$ cowsay <span class="se">\
</span>  -fhellokitty <span class="se">\
</span>  &#x203B;&#x5199;&#x771F;&#x306F;&#x30A4;&#x30E1;&#x30FC;&#x30B8;&#x3067;&#x3059;</pre></div><div class="step step-level-1" step="21" id="csaas-bad" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="22000" data-z="0"><pre class="highlight code dockerfile"><span class="k">FROM</span><span class="s"> debian</span>
<span class="k">COPY</span> --from<span class="o">=</span>builder /src/csaas /bin/
<span class="k">RUN</span> apt-get update
<span class="k">RUN</span> apt-get install -y cowsay
<span class="k">RUN</span> rm -rf /var/lib/apt/lists/*
<span class="k">ENV</span> <span class="nv">PATH</span><span class="o">=</span>/usr/games:/usr/bin:/bin
<span class="k">CMD</span> <span class="p">[</span><span class="s2">"/bin/csaas"</span><span class="p">]</span></pre></div><div class="step step-level-1" step="22" id="csaas-good" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="23000" data-z="0"><pre class="highlight code dockerfile"><span class="k">FROM</span><span class="s"> debian</span>
<span class="k">RUN</span> apt-get update <span class="se">\
</span> <span class="o">&amp;&amp;</span> apt-get install -y cowsay <span class="se">\
</span> <span class="o">&amp;&amp;</span> rm -rf /var/lib/apt/lists/*
<span class="k">COPY</span> --from<span class="o">=</span>builder /src/csaas /bin/
<span class="k">ENV</span> <span class="nv">PATH</span><span class="o">=</span>/usr/games:/usr/bin:/bin
<span class="k">CMD</span> <span class="p">[</span><span class="s2">"/bin/csaas"</span><span class="p">]</span></pre></div><div class="step step-level-1" step="23" id="csaas-size" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="24000" data-z="0"><figure><img src="img/big-cow.png"></img><figcaption>&#x203B;&#x5199;&#x771F;&#x306F;&#x30A4;&#x30E1;&#x30FC;&#x30B8;&#x3067;&#x3059;</figcaption></figure><h1 id="csaas-size">CSaaS Size</h1><table cellpadding="0" cellspacing="0"><thead><tr><th><p>Using</p></th><th><p>Size</p></th></tr></thead><tbody><tr><td><p>RUN</p></td><td><p>186MB</p></td></tr><tr><td><p>&amp;&amp;</p></td><td><p>169MB</p></td></tr></tbody></table></div><div class="step step-level-1" step="24" id="csaas-speed" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="25000" data-z="0"><figure><img src="img/stegosaur.png"></img><figcaption>&#x203B;&#x5199;&#x771F;&#x306F;&#x30A4;&#x30E1;&#x30FC;&#x30B8;&#x3067;&#x3059;</figcaption></figure><h1 id="csaas-speed">CSaaS Speed</h1><table cellpadding="0" cellspacing="0"><thead><tr><th><p>First</p></th><th><p>build</p></th><th><p>rebuild</p></th></tr></thead><tbody><tr><td><p>copy</p></td><td><p>26s</p></td><td><p>26s</p></td></tr><tr><td><p>apt</p></td><td><p>13s</p></td><td><p>4.5s</p></td></tr></tbody></table></div><div class="step step-level-1" step="25" id="hub" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="26000" data-z="0"><figure><a href="https://sfiera.net"><img src="img/newyork.jpg"></img></a><figcaption>&#x203B;&#x5199;&#x771F;&#x306F;&#x30A4;&#x30E1;&#x30FC;&#x30B8;&#x3067;&#x3059;</figcaption></figure><h1 id="docker-hub">Docker Hub</h1><ul><li>AWS US-East</li><li>sfiera/dev (398MB)</li><li>Pull: 14s</li></ul></div><div class="step step-level-1" step="26" id="harbor" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="27000" data-z="0"><figure><a href="https://www.flickr.com/photos/jumilla/14610034513/"><img src="img/harbor.jpg"></img></a><figcaption>&#x203B;&#x5199;&#x771F;&#x306F;&#x30A4;&#x30E1;&#x30FC;&#x30B8;&#x3067;&#x3059;</figcaption></figure><h1 id="line-harbor">LINE Harbor</h1><ul><li>Pull: 14s &#x2192; 14s</li></ul></div><div class="step step-level-1" step="27" id="registry" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="28000" data-z="0"><figure><a href="https://de.wikipedia.org/wiki/Datei:Ouroboros-Abake.svg"><img src="img/ouroboros.png"></img></a><figcaption>&#x203B;&#x5199;&#x771F;&#x306F;&#x30A4;&#x30E1;&#x30FC;&#x30B8;&#x3067;&#x3059;</figcaption></figure><h1 id="localhost">Localhost</h1><pre class="highlight code sh">$ docker run <span class="se">\
</span>  -p <span class="m">5000</span>:5000 <span class="se">\
</span>  registry</pre><ul><li>14s &#x2192; 7s</li></ul></div><div class="step step-level-1" step="28" id="extract" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="29000" data-z="0"><pre class="highlight code">$ docker pull sfiera/dev
Using default tag: latest
latest: Pulling from sfiera/dev
34dce65423d3: Extracting   23.3MB/27.62MB
796769e96d24: Download complete
2a0eada9611d: Download complete
d6830a7cd972: Download complete
0eb560759b5f: Downloading  23.02MB/102.1MB
d7bd1b4be5fc: Waiting
0508d0ce771e: Waiting</pre></div><div class="step step-level-1" step="29" id="fin" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="30000" data-z="0"><figure><a href="https://torange.biz/fin-dolphin-25201"><img src="img/fin.jpg"></img></a><figcaption>&#x203B;&#x5199;&#x771F;&#x306F;&#x30A4;&#x30E1;&#x30FC;&#x30B8;&#x3067;&#x3059;</figcaption></figure><h1 id="fin">fin</h1><div class="notes"><p>intentionally blank</p></div></div><div class="step step-level-1" step="30" id="links" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="31000" data-z="0"><h1 id="sources">Sources</h1><ul><li><a href="http://github.com/sfiera/docker-image-slides">This presentation</a>, with source data</li><li>All images PD, CC-BY, or by author; linked to original</li></ul></div><div class="step step-level-1" step="31" id="blank" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-x="0" data-y="32000" data-z="0"><div class="notes"><p>intentionally blank</p></div></div></div><div id="hovercraft-help" class="hide"><table><tr><th>Space</th><td>Forward</td></tr><tr><th>Right, Down, Page Down</th><td>Next slide</td></tr><tr><th>Left, Up, Page Up</th><td>Previous slide</td></tr><tr><th>G</th><td>Go to slide number</td></tr><tr><th>P</th><td>Open presenter console</td></tr><tr><th>H</th><td>Toggle this help</td></tr></table></div><script type="text/javascript" src="js/impress.js"></script><script type="text/javascript" src="js/impressConsole.js"></script><script type="text/javascript" src="js/hovercraft.js"></script></body></html>